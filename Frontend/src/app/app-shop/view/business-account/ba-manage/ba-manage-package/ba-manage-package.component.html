<div
  class="
                    d-flex
                    flex-sm-row flex-column
                    align-items-sm-center align-items-stretch
                    justify-content-between
                    pb-4
                    mb-2 mb-md-3
                  "
>
  <div class="d-flex flex-sm-row">
    <button id="btnAddPackage"
            class="
                      btn btn-icon btn-outline-primary btn-xs
                      rounded-circle
                      shadow-sm
                    "
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#add-new-package"
            aria-controls="add-new-package"
            aria-expanded="false"
            title="Add new package"
            data-bs-original-title="Add new package"
            aria-label="Add new package"
    >
      <i class="fi-plus"></i>
    </button>
    <h3 class="h4 mb-sm-0 ms-2">
      <!-- <i class="fi-info-circle mt-n1 me-2 lead align-middle text-warning"></i> -->
      Package
    </h3>
  </div>

  <div class="d-flex align-items-center ms-sm-4">
    <label
      class="fs-sm me-2 pe-1 text-nowrap"
      for="review-sorting1"
    ><i class="fi-arrows-sort text-muted mt-n1 me-2"></i>Sort
      by:</label
    >
    <select
      class="form-select form-select-sm"
      id="review-sorting1"
    >
      <option>Newest</option>
      <option>Oldest</option>
      <option>Popular</option>
      <option>High rating</option>
      <option>Low rating</option>
    </select>
  </div>
</div>

<div class="collapse" id="add-new-package">
  <div class="card card-body">

    <!--<form #baManageFormPackage="ngForm"-->
    <!--(ngSubmit)="baManageFormPackage.form.valid && itemPackage.itemItemPackages.length > 0 && onSubmit()" novalidate>-->
    <form #baManageFormPackage="ngForm"
          (ngSubmit)="baManageFormPackage.form.valid && packageItem.itemPackage.itemImgsRaw.length>=3 && onSubmit()" novalidate>

      <div class="row">
        <div class="col-md-12 mb-3">
          <label class="form-label" for="validationTooltipp1"
          >Package name</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Suitable Package name" data-bs-original-title="Suitable Package name"
             aria-label="Suitable Package name"><i class="fi-help"></i>
          </a>
          <input
            class="form-control"
            type="text"
            id="validationTooltipp1"
            placeholder="Package name"
            [(ngModel)]="packageItem.itemPackage.name" #packageName="ngModel" name="packageName"
            required
          />
          <div *ngIf="(packageName.touched || baManageFormPackage.submitted) && packageName.errors?.required"
               class="validErr">
            Package Name is required
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label" for="validationTooltip02">
            Quantity
          </label>
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Item quantity" data-bs-original-title="Item quantity"
             aria-label="Item quantity"><i class="fi-help"></i>
          </a>
          <input
            class="form-control"
            type="number"
            placeholder="Quantity"
            id="validationTooltip02"
            min="1"
            required
            [(ngModel)]="packageItem.itemPackage.quantity" #packageQty="ngModel" name="packageQty"
          />
          <div *ngIf="(packageQty.touched || baManageFormPackage.submitted) && packageQty.errors?.required"
               class="validErr">
            Quantity is required
          </div>
          <div class="valid-tooltip">Looks good!</div>
        </div>
        <div class="col-md-4 mb-3" style="margin-top: 46px">
          <label>
            Make To Order
            <input type="checkbox" name="makeToOrder" style="margin-left: 5px; transform: scale(1.4)"
                   [(ngModel)]="packageItem.itemPackage.makeToOrder">
          </label>
        </div>
      </div>
      <div class="row">
        <div class="col-md-4 mb-3">
          <label class="form-label" for="validationTooltipp2"
          >Discount type</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Please select suitable discount type."
             data-bs-original-title="Please select suitable discount type."
             aria-label="Please select suitable discount type."><i class="fi-help"></i>
          </a>
          <select
            class="form-select"
            id="validationTooltipp2"
            [(ngModel)]="packageItem.itemPackage.discountType" #discountType="ngModel" name="discountType"
          >
            <option value="None">None</option>
            <option value="Cash">Cash</option>
            <option value="Percentage">Percentage</option>
          </select>
          <!--<div *ngIf="(discountType.touched || baManageFormPackage.submitted) && discountType.errors?.required"-->
          <!--class="validErr">-->
          <!--Package Name is required-->
          <!--</div>-->
          <div class="valid-tooltip">Looks good!</div>
        </div>
        <div class="col-md-4 mb-3" *ngIf="packageItem.itemPackage.discountType!=='None'">
          <label class="form-label" for="validationTooltipp3"
          >Discount</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Please enter package discount."
             data-bs-original-title="Please enter package discount." aria-label="Please enter package discount."><i
            class="fi-help"></i>
          </a>
          <input
            class="form-control"
            type="number"
            id="validationTooltipp3"
            placeholder="Discount"
            [(ngModel)]="packageItem.itemPackage.discount" #discount="ngModel" name="discount"
            required
          />
          <div *ngIf="(discount.touched || baManageFormPackage.submitted) && discount.errors?.required"
               class="validErr">
            Discount is required
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <label class="form-label" for="validationTooltipp3"
          >Price (LKR)</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Please enter package price."
             data-bs-original-title="Please enter package price." aria-label="Please enter package price."><i
            class="fi-help"></i>
          </a>
          <!-- <input
            class="form-control"
            type="text"
            id="validationTooltip02"
            placeholder="Price"
            value=""
            required
          /> -->
          <div class="input-group">
            <span class="input-group-text fs-lg py-1">LKR</span>
            <input type="number" class="form-control" id="validationTooltipp3" placeholder="Amount" required
                   [(ngModel)]="packageItem.itemPackage.price" #price="ngModel" name="price">
            <!--<span class="input-group-text">.00</span>-->
            <!--<div class="invalid-tooltip">-->
            <!--Please enter itemPackage price-->
            <!--</div>-->
            <!--<div class="valid-tooltip">Looks good!</div>-->
          </div>
          <div *ngIf="(price.touched || baManageFormPackage.submitted) && price.errors?.required"
               class="validErr">
            Price is required
          </div>

        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mb-3">
          <label class="form-label"
          >Business type </label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Select this item belongs to which type of business"
             data-bs-original-title="Select this item belongs to which type of business"
             aria-label="Select this item belongs to which type of business"><i class="fi-help"></i>
          </a>
          <!-- <div class="d-flex flex-column flex-sm-row"> -->
          <ng-select
            [items]="businessCategories"
            bindLabel="name"
            placeholder="Select Business Type"
            dropdownPosition="auto"
            [multiple]="false"
            [searchWhileComposing]="true"
            name="businessProfileCategories"
            #businessProfileCategories="ngModel" required
            (change)="getItems();getItemPackageFeatures()"
            [(ngModel)]="packageItem.itemPackage.businessProfileCategory.businessCategory">
          </ng-select>
          <div
            *ngIf="(businessProfileCategories.touched || baManageFormPackage.submitted) && businessProfileCategories.errors?.required"
            class="validErr">
            Business type is required
          </div>
          <!-- <div class="invalid-tooltip">
            Please fill item quantity
          </div>
          <div class="valid-tooltip">Looks good!</div> -->
          <!-- <button type="button" class="btn btn-light-primary btn-icon shadow-sm">
            <i class="fi-plus"></i>
          </button> -->
          <!-- <button class="btn btn-translucent-primary rounded-pill" type="button">Add</button> -->
          <!-- </div> -->

        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mb-3">
          <label class="form-label" for="validationTooltip04"
          >Items</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="You can add items for this pakage."
             data-bs-original-title="You can add items for this pakage."
             aria-label="You can add items for this pakage."><i class="fi-help"></i>
          </a>
          <!--<form #baManageFormPackageItemExs="ngForm" (ngSubmit)="baManageFormPackageItemExs.form.valid && addItem()"-->
          <!--novalidate>-->

          <div class="d-flex flex-column flex-sm-row">
            <div style="width: 100%">
              <div>
                <ng-select
                  [items]="itemsToAdd"
                  bindLabel="name"
                  placeholder="Select Item"
                  dropdownPosition="auto"
                  [multiple]="true"
                  [searchWhileComposing]="true"
                  name="items"
                  #itemsE="ngModel" required
                  [(ngModel)]="packageItem.packageItemItems"
                  style="width: 100%">
                </ng-select>
              </div>
              <div
                *ngIf="(baManageFormPackage.submitted) && packageItem.packageItemItems.length===0"
                class="validErr">
                Item is required
              </div>
              <!--<div style="color: blue;padding-left: 10px;padding-top: 5px">-->
              <!--Add new feature-->
              <!--</div>-->
            </div>
            <!-- <div class="invalid-tooltip">
              Please fill item quantity
            </div>
            <div class="valid-tooltip">Looks good!</div> -->
            <!--<button style="margin-left: 10px" type="submit"-->
            <!--class="btn btn-light-primary btn-icon shadow-sm">-->
            <!--<i class="fi-plus"></i>-->
            <!--</button>-->
            <!-- <button class="btn btn-translucent-primary rounded-pill" type="button">Add</button> -->
          </div>
          <!--</form>-->
        </div>
      </div>
      <!--<div class="row">-->
      <!--<div class="d-flex flex-wrap mb-4">-->
      <!--<span *ngFor="let itemPackage of itemPackage.itemItemPackages;let i = index"-->
      <!--class="bg-success text-light fs-sm btn btn-xs opacity-100 rounded-pill me-2 mb-2 ms-1 mt-1">{{itemPackage.name}}-->
      <!--<i class="fi-x fs-xs ms-2" (click)="itemPackage.itemItemPackages.splice(i,1)"-->
      <!--style="cursor: pointer"></i>-->
      <!--</span>-->
      <!--</div>-->
      <!--</div>-->
      <div class="row">
        <div class="col-md-12 mb-3">
          <label class="form-label" for="validationTooltip04"
          >Features</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="You can add if there any features"
             data-bs-original-title="You can add if there any features"
             aria-label="You can add if there any features"><i class="fi-help"></i>
          </a>
          <a href="#new-packageFeature" data-bs-toggle="modal" data-bs-dismiss="modal"
             class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-3 fw-bold"
             title="You can create new feature." data-bs-original-title="You can create new feature."
             aria-label="You can create new feature." style="padding-left: 20px;padding-top: 4px">Create Feature
          </a>

          <form #baManageFormPackageExs="ngForm"
                (ngSubmit)="baManageFormPackageExs.form.valid && addFeature()"
                novalidate>

            <div class="d-flex flex-column flex-sm-row">
              <div style="width: 100%">
                <div>
                  <ng-select
                    [items]="itemPackageFeatures"
                    bindLabel="name"
                    placeholder="Select Feature"
                    dropdownPosition="auto"
                    [multiple]="false"
                    [searchWhileComposing]="true"
                    name="iFeature"
                    #iFeature="ngModel" required
                    [(ngModel)]="itemPackageItemPackageFeature"
                    style="width: 100%">
                  </ng-select>
                </div>
                <div *ngIf="(baManageFormPackageExs.submitted) && itemPackageFeature===undefined"
                     class="validErr">
                  Feature is required
                </div>
                <!--<div style="color: blue;padding-left: 10px;padding-top: 5px">-->
                <!--Add new feature-->
                <!--</div>-->
              </div>
              <!-- <div class="invalid-tooltip">
                Please fill item quantity
              </div>
              <div class="valid-tooltip">Looks good!</div> -->
              <button style="margin-left: 10px" type="submit"
                      class="btn btn-light-primary btn-icon shadow-sm">
                <i class="fi-plus"></i>
              </button>
              <!-- <button class="btn btn-translucent-primary rounded-pill" type="button">Add</button> -->
            </div>
          </form>

        </div>
      </div>
      <div class="row">
        <div class="d-flex flex-wrap mb-4">
                <span *ngFor="let itemPackageFeature of packageItem.itemPackage.itemPackageItemPackageFeatures;let j = index"
                      class="bg-success text-light fs-sm btn btn-xs opacity-100 rounded-pill me-2 mb-2 ms-1 mt-1">{{itemPackageFeature.itemPackageFeature.name}}
                  <i class="fi-x fs-xs ms-2" (click)="packageItem.itemPackage.itemPackageItemPackageFeatures.splice(i,1)"
                     style="cursor: pointer"></i>
                </span>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mb-3">
          <label class="form-label" for="validationTooltipp5"
          >Description</label
          >
          <a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"
             data-bs-toggle="tooltip" title="Small description about your package."
             data-bs-original-title="Small description about your package."
             aria-label="Small description about your package."><i class="fi-help"></i>
          </a>
          <textarea class="form-control" id="validationTooltipp5" rows="5" placeholder="Description"
                    [(ngModel)]="packageItem.itemPackage.description" name="description"></textarea>
          <div class="invalid-tooltip">
            Please write something about your package
          </div>
          <div class="valid-tooltip">Looks good!</div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mb-3">
          <div class="alert alert-info mb-4" role="alert">
            <div class="d-flex"><i class="fi-alert-circle me-2 me-sm-3"></i>
              <p class="fs-sm mb-1">The maximum photo size is 5 MB. Formats: jpeg, jpg, png. Put the main picture
                first.</p>
            </div>
          </div>
          <!--<input class="file-uploader file-uploader-grid" type='file' accept="image/*" #imageInput="ngModel"-->
          <!--data-max-file-size="5MB"-->
          <!--[(ngModel)]="imgUrl" name="imageInput"-->
          <!--(change)="processFile($event)" required>-->
          <file-pond
            class="file-uploader-grid"
            #imageInput
            [options]="pondOptions"
            name="imageInput"
            (onaddfile)="pondHandleAddFile($event)"
            (onremovefile)="pondHandlerRemoveFile($event)">
          </file-pond>
          <!--<input class="file-uploader file-uploader-grid" type="file" multiple data-max-file-size="10MB"-->
          <!--accept="image/png, image/jpeg"-->
          <!--data-label-idle="&lt;div class=&quot;btn btn-primary mb-3&quot;&gt;&lt;i class=&quot;fi-cloud-upload me-1&quot;&gt;&lt;/i&gt;Upload photos&lt;/div&gt;&lt;br&gt;or drag them in">-->
        </div>
        <div
          *ngIf="(packageItem.itemPackage.itemImgsRaw.length<3 && baManageFormPackage.submitted)"
          class="validErr" style="margin-bottom: 10px">
          Minimum 3 images are required
        </div>
      </div>
      <div class="mb-3 py-2">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="invalidCheckP"
            [(ngModel)]="packageItem.itemPackage.isNewPackage"
            name="newPackage"
            required
          />
          <label class="form-check-label" for="invalidCheckP"
          >I confirm that the information provided information is accurate and correct.</label
          >
          <div class="invalid-tooltip">
            You must agree before submitting.
          </div>
        </div>
      </div>
      <button class="btn btn-primary btn-md" type="submit" [disabled]="!packageItem.itemPackage.isNewPackage">
        Save
      </button>
    </form>
  </div>
</div>

<!--<div class="row" style="margin-top: 30px">-->
<!--<div class="col-md-12 mb-3">-->
<!--&lt;!&ndash;<label class="form-label"&ndash;&gt;-->
<!--&lt;!&ndash;&gt;Business type </label&ndash;&gt;-->
<!--&lt;!&ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;<a class="btn btn-icon btn-light btn-xs text-primary content-overlay mb-2 ms-auto help"&ndash;&gt;-->
<!--&lt;!&ndash;data-bs-toggle="tooltip" title="Select this item belongs to which type of business"&ndash;&gt;-->
<!--&lt;!&ndash;data-bs-original-title="Select this item belongs to which type of business"&ndash;&gt;-->
<!--&lt;!&ndash;aria-label="Select this item belongs to which type of business"><i class="fi-help"></i>&ndash;&gt;-->
<!--&lt;!&ndash;</a>&ndash;&gt;-->
<!--&lt;!&ndash; <div class="d-flex flex-column flex-sm-row"> &ndash;&gt;-->
<!--<ng-select-->
<!--[items]="businessCategories"-->
<!--bindLabel="name"-->
<!--placeholder="Select Business Type"-->
<!--dropdownPosition="auto"-->
<!--[multiple]="false"-->
<!--[searchWhileComposing]="true"-->
<!--(change)="getItemPackagesOrdered()"-->
<!--[(ngModel)]="businessProfileCategory">-->
<!--</ng-select>-->
<!--&lt;!&ndash; <div class="invalid-tooltip">-->
<!--Please fill item quantity-->
<!--</div>-->
<!--<div class="valid-tooltip">Looks good!</div> &ndash;&gt;-->
<!--&lt;!&ndash; <button type="button" class="btn btn-light-primary btn-icon shadow-sm">-->
<!--<i class="fi-plus"></i>-->
<!--</button> &ndash;&gt;-->
<!--&lt;!&ndash; <button class="btn btn-translucent-primary rounded-pill" type="button">Add</button> &ndash;&gt;-->
<!--&lt;!&ndash; </div> &ndash;&gt;-->

<!--</div>-->
<!--</div>-->

<div class="modal fade" role="dialog" id="new-packageFeature" tabindex="-1" aria-hidden="true" style="z-index: 9999">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <ul class="nav nav-tabs mb-0" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" href="#add-feature" data-bs-toggle="tab" role="tab" aria-selected="true">
              <i class="fi-plus fs-sm me-2 ms-n1"></i>
              Add new Feature
            </a>
          </li>
        </ul>
        <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body tab-content py-4">
        <div class="alert alert-info d-flex" role="alert">
          <i class="fi-alert-circle me-2 me-sm-3 lead"></i>
          <div>It takes few minutes to review your feature.Then we will add it into your item.</div>
        </div>
        <form class="tab-pane fade show active" autocomplete="off" id="add-feature-e"
              #baManageFormPackageFeature="ngForm"
              (ngSubmit)="baManageFormPackageFeature.form.valid && addFeatureTemp()" novalidate>
          <div class="mb-3">
            <label class="form-label" for="feature">Feature</label>
            <div style="display: flex">
              <input class="form-control" type="text" id="featureE" placeholder="Enter your feature"
                     required [(ngModel)]="newPackageFeature" #newFeatureE="ngModel" name="newFeature">
              <button style="margin-left: 10px" type="submit"
                      class="btn btn-light-primary btn-icon shadow-sm">
                <i class="fi-plus"></i>
              </button>
            </div>
          </div>
          <div *ngIf="(newFeatureE.touched || baManageFormPackageFeature.submitted) && newFeatureE.errors?.required"
               class="validErr" style="margin-bottom: 10px">
            Item Feature is required
          </div>
          <div class="row">
            <div class="d-flex flex-wrap mb-4">
                <span *ngFor="let packageFeature of newPackageFeaturesTemp;let i = index"
                      class="bg-success text-light fs-sm btn btn-xs opacity-100 rounded-pill me-2 mb-2 ms-1 mt-1">{{packageFeature.name}}
                  <i class="fi-x fs-xs ms-2" (click)="newPackageFeaturesTemp.splice(i, 1)"
                     style="cursor: pointer;z-index: 9"></i>
                </span>
            </div>
          </div>

          <div class="mb-3 d-flex flex-wrap justify-content-between">
            <div class="form-check mb-2">
              <input class="form-check-input" type="checkbox" id="trueinfoconfirmE" [(ngModel)]="isNewFeature"
                     name="newFeatureC">
              <label class="form-check-label" for="trueinfoconfirm">I confirm that the provided information
                is accurate and correct.</label>
            </div>
          </div>
          <button data-bs-dismiss="modal" class="btn btn-primary d-block w-100" type="button"
                  (click)="addNewPackageFeature()" [disabled]="!isNewFeature">Save
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<app-ba-manage-package-edit [packageItems]="packageItems"></app-ba-manage-package-edit>
